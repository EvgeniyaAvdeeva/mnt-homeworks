# Домашнее задание к занятию "10.06. Инцидент-менеджмент"

## Задание 

Составьте постмортем, на основе реального сбоя системы Github в 2018 году.

Информация о сбое доступна [в виде краткой выжимки на русском языке](https://habr.com/ru/post/427301/) , а
также [развёрнуто на английском языке](https://github.blog/2018-10-30-oct21-post-incident-analysis/).

### Краткое описание

Отображение устаревшей и непоследовательной информации на сайте GitHub.

### Предшествующие события

Замена вышедшего из строя оптического оборудования
в рамках регламентых работ.

### Причина

Потеря связи между сетевым концентратором на восточном побережье США
и основным центром обработки данных на восточном побережье США

### Воздействие

GitHub также не мог обслуживать события веб-перехватчиков или создавать и публиковать сайты GitHub Pages

### Обнаружение

Система мониторинга зафиксировала проблему

### Реакция

24 часа 11 минут

### Восстановление

- Из резервных копий были восстановлены БД
- Синхронизированны реплики
- Возвращена исходная топология
- Затем возобновлена обработка заданий в очереди

### Таймлайн:
*2018 21 октября 22:54 UTC*

Мониторинг сообщил о многочисленных сбоях.
К 23:02 UTC инженеры нашей группы быстрого реагирования определили, что топологии многочисленных кластеров баз данных находятся в непредвиденном состоянии.

*2018 21 октября 23:07 UTC*

Решено заблокировать внутренний инструмент развертывания.
В 23:09 сайт был помещен в желтый статус, в 23:13 статус перевели в красный цвет.

*2018 21 октября 23:13 UTC*

Стало очевидно, что проблема затронула несколько кластеров бд.
Вызваны деж. инженеры бд гитхаб.
Они искали решение, как настроить бд вручную в качестве основной для каждого кластера и перестроить топологию репликации.

*2018 21 октября 23:19 UTC*

Из запроса состояния кластеров базы данных стало ясно, что нам нужно остановить выполнение заданий, записывающих метаданные о таких вещах, как push-уведомления. 

*22 октября 2018 г., 00:05 UTC*

Начали разрабатывать план по устранению несоответствий данных и внедрению наших процедур аварийного переключения для MySQL. 

*22 октября 2018 г., 00:41 UTC*

Несколько кластеров завершили восстановление из резервных копий в нашем цод на Вост. побережье и начали репликацию новых данных с западного побережья.

*22 октября 2018 07:46 UTC*

GitHub опубликовал сообщение в блоге, чтобы предоставить больше контекста.

*22 октября 2018 г., 11:12 UTC*

Все первичные базы данных снова установлены на восточном побережье США.

*22 октября 2018 г., 13:15 UTC*

К настоящему времени мы приближались к пиковой нагрузке трафика на GitHub.com. Группа реагирования на инциденты обсудила, как действовать дальше.
Мы начали предоставлять дополнительные реплики чтения MySQL в общедоступном облаке восточного побережья США ранее во время инцидента. Как только они стали доступны, стало проще распределять объем запросов на чтение по большему количеству серверов. Сокращение совокупного использования реплик чтения позволило репликации наверстать упущенное.

*22 октября 2018 г., 16:24 UTC*

Как только реплики были синхронизированы, мы выполнили аварийное переключение на исходную топологию, решив немедленные проблемы с задержкой/доступностью.

*22 октября 2018 г., 16:45 (всемирное координированное время)*

На этом этапе восстановления нам нужно было сбалансировать возросшую нагрузку, представленную отставанием, потенциально перегружая наших партнеров по экосистеме уведомлениями, и как можно быстрее вернуть наши услуги на 100%.

*22 октября 2018 23:03 UTC*

Все ожидающие сборки вебхуков и страниц были обработаны, и была подтверждена целостность и правильная работа всех систем. 




---

### Последующие действия

- Анализ и устранение несоответствий данных, которые не были реплицированы на сайт Зап. побережья
- Настройка конфигурации  Orchestrator
- ускорен переход на новый механизм отчетов о состоянии сайта, т.к. статусы не дают полного понимания о том, что работает на текущий момент, а что нет 
- Запущен проект по поддержка резервирования N+1 на уровне объекта.  Цель этой работы — допустить полный отказ одного центра обработки данных без воздействия на пользователя



### Как оформить ДЗ?

Выполненное домашнее задание пришлите ссылкой на .md-файл в вашем репозитории.

---
